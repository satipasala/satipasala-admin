rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
   match /{allPaths=**} {
      allow read: if request.auth!=null;
      }

    match /event_pictures/{imageId} {
      allow read : if request.auth != null;
      allow write: if request.auth != null && validateImageResource();
    }

    match /profile_pictures/{imageId} {
      allow read : if request.auth != null;
      allow write: if request.auth != null && validateImageResource();
    }

    function isAuthorizedToEditProfilePhoto(imageId){
      return request.auth.token.email == imageId
    }

    function validateImageResource(){
      return (request.resource.size < 5242880);
    }

  }
}
